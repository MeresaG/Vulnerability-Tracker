const Joi = require('joi');
const { joiPassword } = require('joi-password');

const personValidation =  (data) => {

    const Schema = Joi.object ({
        userName: Joi.string().required(),
        role : Joi.string().required(),
        firstName: Joi.string().required(),
        lastName: Joi.string().required(),
        email: Joi.string().min(6).required().email(),
        password: joiPassword.string()
                .minOfSpecialCharacters(1)
                .minOfLowercase(1)
                .minOfUppercase(1)
                .noWhiteSpaces()
                .min(8)
                .required()
    });
    return Schema.validate(data);


}

const loginValidation =  (data) => {
            const schema = Joi.object ({
                email: Joi.string().min(6).required().email(),
                password: joiPassword.string()
                        .minOfSpecialCharacters(1)
                        .minOfLowercase(1)
                        .minOfUppercase(1)
                        .noWhiteSpaces()
                        .min(8)
                        .required()
            });
           return schema.validate(data);
}

module.exports = {
    personValidation: personValidation,
    loginValidation : loginValidation 
}