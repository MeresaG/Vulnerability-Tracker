const express = require('express');
const router = express.Router();

const auth = require('./verifyToken')

const vulnerabilityController = require('../controller/volunerabilityController');
const commentController = require('../controller/commentController');

router.route('/vulnerabilities')
        .get(auth, vulnerabilityController.getAllVulnerabilities)
        .post(auth, vulnerabilityController.AddOneVulnerability)


router.route('/vulnerabilities/:vulnerabilityId')
        .get(auth, vulnerabilityController.getOneVulnerability)
        .put(auth, vulnerabilityController.fullUpdateVulnerability)
        .patch(auth, vulnerabilityController.partialUpdateVulnerability)
        .delete(auth, vulnerabilityController.deleteOneVulnerability)


router.route('/vulnerabilities/:vulnerabilityId/comments')
        .get(auth, commentController.getAllComments)
        .post(auth, commentController.addOneComment)

router.route('/vulnerabilities/:vulnerabilityId/comments/:commentId')
        .get(auth, commentController.getOneComment)
        .put(auth, commentController.fullUpdateComment)
        .patch(auth, commentController.partialUpdateComment)
        .delete(auth, commentController.deleteOneComment)



module.exports = router;