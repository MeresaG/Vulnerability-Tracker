const express = require('express');
const passport = require('passport');
const router = express.Router();
const auth = require('./verifyToken')

const personController = require('../controller/personController');


/**
 * @desc auth
 * @route POST /auth/signin
 */
router.route('/signin')
        .post(personController.signinPerson)


/**
 * @desc auth
 * @route POST /auth/signup
 */
 router.route('/signup')
 .post(auth, personController.signupPerson)



/**
 * @desc auth with google 
 * @route GET /auth/google
 */

 router.get('/google', passport.authenticate('google', {scope: ['profile', 'email']}));
 
 /**
  * @desc Google with callback
  * @route GET /auth/google/callback
  */
 
 router.get('/google/callback',
 passport.authenticate( 'google', {
     successRedirect: 'http://localhost:4200/home',
     failureRedirect: 'http://localhost:4200/'
 }));
 
 /**
  * @desc Logout user
  *  @route /auth/logout
  */
 router.get('/logout', (req, res) => {
     req.logout()
     res.redirect('/');
 })
 
 module.exports = router;